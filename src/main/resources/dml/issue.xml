<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="issue">
<!-- 프로젝트 전체 리스트(모집완료된 데이터) -->
<select id="selectAllProjectList" resultType="com.toy.project.model.ProjectDto" parameterType="String">
select a.user_id, b.project_id, b.project_name 
from projectmember a
join
  (select project_id, project_name, state_code from project
  ) b
on a.project_id = b.project_id
where a.user_id = #{user_id}
</select>

<!-- 프로젝트 이슈 참여자 대상 조회하기 -->
<select id="selectApplyListFromProjectMember" resultType="com.toy.issue.model.projectMemberDto"  parameterType="String">
select a.user_id, b.project_id, b.project_name 
from projectmember a
join
  (select project_id, project_name, state_code from project
  ) b
on a.project_id = b.project_id
where a.project_id = #{projectId}
</select>

<!-- 프로젝트에 해당하는 이슈리스트 -->
<select id="selectIssueList" resultType="com.toy.issue.model.issueDto"  parameterType="String">
select a.issue_id, a.project_id, a.issue_name
from issue a
join project b
on a.project_id = b.project_id
where a.project_id = #{projectId}
</select>

<!-- 이슈생성 (날짜 추후 추가예정) -->
<insert id = "insertIssue" parameterType = "com.toy.issue.model.issueDto">
insert into issue (issue_id, project_id, issue_detail, issue_name, reg_date, reg_id)
values(
	#{issue_id}, 
	#{project_id}, 
	#{issue_detail},
	#{issue_name},
	sysdate,
	#{reg_id}
)
</insert>
</mapper>